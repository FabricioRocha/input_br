10 KEYOFF : MOTOROFF
20 CLS: CLEAR: R$="P RMCAI"
30 CLS:LOCATE 5,1:PRINT" M E N U   P R I N C I P A L "

40 LOCATE 9,5 :PRINT" 1: -ABRIR UM ARQUIVO"
50 LOCATE 9,7 :PRINT" 2: -ENTRADA DE REGISTROS"
60 LOCATE 9,9 :PRINT" 3: -LISTAR REGISTROS"
70 LOCATE 9,11:PRINT" 4: -BUSCA DE INFORMAÇÖES"
80 LOCATE 9,13:PRINT" 5: -GRAVAR UM ARQUIVO"
90 LOCATE 9,15:PRINT" 6: -CARREGA UM ARQUIVO"
100 LOCATE 9,17:PRINT" 7: -FIM DE PROGRAMA"
110 LOCATE 14,19:PRINT" OPÇAO: ";
120 IN$=INKEY$: IF IN$<"1" OR IN$>"7" THEN120
130 IF IN$<>"1" AND IN$<>"6" AND IN$<>"7" AND R=0 THEN 120

140 PRINT CHR$(7):CLS:IN=VAL(IN$)
150 ON IN GOSUB 1000,2000,6000,5000,7000,8000,9000
160 GOTO 30

1000 LOCATE 7,0: PRINT "MONTAR UM NOVO ARQUIVO":LOCATE 7,14:PRINT"Você tem certeza (S/N) ?";
1010 IN$=INKEYS : IF IN$<>"S" AND IN$<>"N" THEN 1010
1020 IF IN$<> "S" THEN RETURN
1030 IF R>0 THEN RUN 9200
1040 CLS : LOCATE 7,0: PRINT "MONTAR UM NOVO ARQUIVO"
1050 LOCATE 4,2:PRINT "Número de campos (1-8) ";:INPUT A:A-ABS(INT(A))
1060 IF A>8 OR A<1 THEN 1050
1070 DIM A(A), N$(A)
1080 LOCATE 0,6:FOR N=1 TO A
1090 PRINT :PRINT"Nome do campo ";N;"? ";:LINE INPUT N$(N):N$(N)=LEFT$(N$(N),10)
1100 PRINT" Tamanho do campo ";N;:INPUT A(N):A(N)=ABS(INT(A(N)))
1110 IF A(N)>25 OR A(N)<1 THEN 1100
1120 TS=TS+A(N)
1130 NEXT:R=INT(3000/(TS+3*A)):PRINT:PRINT"Número máximo de registros =>";R
1140 DIM A$(R+1,A):FOR I=1T01000:NEXT:RETURN

2000 G=0
2010 IF NR=R THEN 2190
2020 NR=NR+1
2030 CLS:PRINT NR-1 ;" de ";R;" registros em uso"
2040 FOR N=1TOA: LOCATE 0, N*2+2:PRINT N$(N);": "LOCATE 0,22:PRINT CHR$(5);:LOCATE 0,23: PRINT CHR$(5);
2050 LOCATE 0,23:PRINT "Até "; A(N);" caracteres'";
2060 LOCATE 0,21:PRINT CHR$(21);:LINE INPUT A$(NR,N)
2070 IF A$(NR, N)="" AND N-1 THEN N=A:G=l:GOTO 2090
2080 A$(NR, N)=LEFT$(A$(NR,N),A(N)):LOCATE 12,N*2+2:PRINT A$(NR,N)
2090 NEXT
2100 IF G=1 THEN 2170
2110 C=NR:FOR F=1 TO 500:NEXT:IF NR=1 THEN 2160
2120 IF A$(C,1)>=A$(C-1,1) THEN 2160
2130 FOR N=1TOA:SWAP A$(C,N),A$(C-1,N):NEXT:C=C-1
2140 IF C=1 THEN 2160
2150 GOTO 2120
2160 GOTO 2010
2170 NR=NR-1
2180 RETURN
2190 CLS:LOCATE 10,15: PRINT"ARQUIVO CHEIO!":FOR F=1 TO 1000:NEXT
2200 RETURN

3000 GOSUB 8500
3010 LOCATE 0,22:PRINT "Modificar qual campo? (1 até ";A;")";:
3020 IN$=INKEY$:IF IN$="" THEN 3020
3030 J=VAL(IN$)
3040 IF J<1 OR J>A THEN 3020
3060 LOCATE 0,22:PRINT SPACE$(39);:LOCATE 0,22:PRINT "Entre com o campo modificado: ";:LINE INPUT A$(D,J)
3070 A$(D,J)=LEFT$(A$(D,J),A(J))
3080 IF D=R THEN J=-1:GOTO 3130
3090 IF D=1 THEN J=1:GOTO3120
3100 IF A$(D,1)>A$(D+1,1) THEN J=1
3110 IF A$(D,1)<A$(D-1,1) THEN J=-1
3120 IF A$(D+1,1)="" AND J=1 THEN 3180
3130 IF J=1 THEN 3160
3140 IF A$(D,1)>=A$(D-1,1) THEN 3180
3150 FOR N=1 TO A:SWAP A$(D,N),A$(D-1,N):NEXT:D=D-1:GOTO 3080
3160 IF A$(D,1) <= A$(D+1,1) THEN 3180
3170 FOR N=1 TO A:SWAP A$(D,N),A$(D+1,N):NEXT:D-D+1:GOTO 3080
3180 FOR F=1 TO 300:NEXT:RETURN

4000 G=D
4010 GOSUB 8500
4020 LOCATE 0,22: PRINT "Você confirma a deleção? (S/N)";
4030 IN$=INKEY$:IF IN$="" THEN 4030
4040 IF IN$<>"S" THEN RETURN
4050 IF G=NR THEN G=G-1
4060 CLS:LOCATE 12,15:PRINT CHR$(7):"Apagando";CHR$(7);
4070 IF D=NR THEN 4090
4080 FOR N=1 TO A:A$(D,N)=A$(D+1,N):NEXT:D=D+1:GOTO 4070
4090 FOR N=1 TO A:A$(D,N)="":NEXT:NR=NR-1:D=G
4100 FOR F=1 T0 400:NEXT:RETURN

5000 FOR N=1 TO A:LOCATE 5, 2*N+2: PRINT N, N$(N):NEXT
5010 LOCATE 0,22:PRINT "Procurar por qual campo? (1 até "; A; ")";
5020 IN$ = INKEY$ : IF IN$= "" THEN 5020
5030 IF VAL(IN$)<1 OR VAL(IN$)>A THEN 5020
5040 PRINTCHR$(7);:Z=VAL(IN$):LOCATE 0,22:PRINT "Procurar o que no campo ";Z;"?";SPACE$(8)
5050 LINE INPUT Z$
5060 D=1:G=0:CH=1
5070 IF D>NR AND G=1 THEN G=0:CH=-1 ELSE IF D>NR THEN 5230
5080 IF D<1 AND G=1 THEN G=0:CH=1 ELSE IF D<1 THEN 5230
5090 IF A$(D,Z)<>Z$ THEN D=D+CH:GOTO 5070
5100 LD=D:G=1:GOSUB 8500
5110 LOCATE 3,22:PRINT"[P]rossegue   [Rletorna   [M]enu   [C]orrige   [A]paga   [I]mprime";
5120 IN$=INKEY$:IF IN$="" THEN 5120
5130 IN=INSTR(1,R$,IN$)
5140 ON IN GOTO 5160, 5160, 5170, 5180, 5190, 5200, 5210
5150 GOTO 5120
5160 CH=1:D=D+1:GOTO 5070
5170 CH=-1:D=D-1:GOTO 5070
5180 RETURN
5190 GOSUB 3000 :GOTO 5090
5200 GOSUB 4000 :GOTO 5090
5210 GOSUB 10000:GOTO 5070
5220 GOTO5 5110
5230 CLS:LOCATE 0,15:PRINT"Não encontrei ";Z$;" em ";N$(Z)
5250 FOR F=1 TO 500 : NEXT:RETURN

6000 D=1
6010 IF NR<1 THEN 6170
6020 GOSUB 8500
6030 LOCATE 3,22:PRINT"[P]rossegue   [Rletorna   [M]enu   [C]orrige   [A]paga   [I]mprime";
6040 IN$=INKEY$:IF IN$="" THEN 6040
6050 IN=INSTR (1,R$,IN$)
6060 ON IN GOTO 6080,6080,6090,6100,6110,6120,6130
6070 GOTO 6030
6080 D=D+1:GOTO61l40
6090 D=D-1:GOTO61440
6100 RETURN

6110 G0SUB 3000:GOTO 6020
6120 GOSUB 4000:GOTO 6010
6130 GOSUB 10000:GOTO 6020
6140 IF D>NR THEN D=1
6150 IF D<1 THEN D=NR
6160 GOTO 6010
6170 CLS:LOCATE 10,15: PRINT"ARQUIVO VAZIO!"
6180 FOR F=1 TO 500:NEXT:RETURN

7000 MOTOR:CLS:LOCATE 0,5: PRINT"Posicione a fita e tecle [return]"
7010 IN$=INKEY$:IF IN$<>CHR$(13) THEN 7010
7020 MOTOR:PRINT:PRINT:PRINT "Coloque o gravador em modo de gravação e pressione [return]"
7030 IN$=INKEY$:IF IN$<>CHR$(13) THEN 7030
7040 PRINT:INPUT "Nome do arquivo ";FLS:F$="CAS:"+FL$
7050 LOCATE 10,22:PRINT " Gravando...";

7060 MOTOR:FOR I=1 TO 1000:NEXT
7070 OPEN FL$ FOR OUTPUT AS #1
7080 PRINT #1,FL$; ",";R,A,NR
7090 FOR N=1 TO A:PRINT #1, N$(N);",";A(N):NEXT
7100 C=1
7110 IF A$(C,1)="" THEN 7140
7120 FORN=1 TO A:PRINT #1,A$(C,N):NEXT
7130 C=C+1:GOTO 7110
7140 CLOSE #1: RETURN

8000 CLS:LOCATE 10,15:PRINT"Você tem certeza? (S/N) "
8010 IN$=INKEY$:IF IN$<>"S" AND IN$<>"N" THEN 8010
8020 IF IN$="N" THEN RETURN
8030 MOTOR: CLS : LOCATE 0,3: PRINT "Posicione a fita e tecle [return]"
8040 IN$=INKEY$:IF IN$<>CHR$(13) THEN 8040
8050 MOTOR:LOCATE 0,7:PRINT"Cologue o gravador em modo de reprodução e tecle [return]"
8060 IN$=INKEY$:IF IN$<>CHR$(13) THEN 8060
8070 IF R>0 THEN RUN 9210
8080 PRINT:INPUT "Nome do arquivo ";FL$:F$="CAS:"+FL$
8090 LOCATE 10,22:PRINT" Procurando..."
8100 OPEN F$ FOR INPUT AS #1
8110 INPUT #1, FL$
8120 CLS:LOCATE 10,15: PRINT "Achei ";FL$

8130 INPUT #1,R,A,NR
8140 DIM A(A), N$(A), A$(R,A)
8150 FOR N=1 TO A:INPUT #1,N$(N),A(N):NEXT
8160 C=1
8170 IF EOF(1) THEN 8200
8180 FOR N=1 TO A:INPUT #1,A$(C,N)
8190 NEXT:C=C+1:GOTO 8170
8200 CLOSE #1:RETURN
8500 CLS: PRINT "Número do registro =>";D:FOR N=1 TO A:LOCATE0,N*2+2:PRINT N$(N);" :";:LOCATE 13:PRINT A$(D,N):NEXT:RETURN

9000 CLS:LOCATE 10,15:PRINT "Você tem certeza? (S/N) "
9010 IN$=INKEY$:IF IN$<>"S" AND IN$<>"N" THEN 9010
9020 IF N$="N" THEN RETURN
9030 CLS:END
9200 GOSUB 1040:GOTO 9220
9210 GOSUB 8080
9220 R$="P RMCAI"

10000 CLS:LOCATE 10,15:PRINT"CHEQUE A IMPRESORA"
10010 PRINT:LOCATE 12: PRINT"ALINHE O PAPEL"
10020 IN$=INKEY$:IF IN$="" THEN 10020
10040 LPRINT: LPRINT "Registro número ";D
10050 FOR X=1 TO A:LPRINT:LPRINT N$(X);" :";A$(D,X):NEXT
10060 LPRINT:LPRINT:LPRINT:LPRINT
10070 CLS:RETURN







